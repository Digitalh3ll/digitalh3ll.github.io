<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        body{
            background-color: black;
        }
        a{
            text-decoration: node;
            color: red;
            text-decoration-line: none;
            text-decoration-color: none;
        }
        a:hover{
            text-decoration: node;
            color: red;
            text-decoration-line: none;
            text-decoration-color: none;
        }
    </style>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICS hacking</title>
</head>
<body>
<pre style="color: white">
<a style="color: red">[Introdução a ICS e o SCADA para pentest]</a>
[by kasparov]

          ) ) )                     ) ) )
        ( ( (                      ( ( (
      ) ) )                       ) ) )
   (~~~~~~~~~)                 (~~~~~~~~~)
    | SCADA |                   |  ICS  |
    |       |                   |       |
    I      _._                  I       _._
    I    /'   `\                I     /'   `\
    I   |   N   |               I    |   N   |
    f   |   |~~~~~~~~~~~~~~|    f    |    |~~~~~~~~~~~~~~|
  .'    |   ||~~~~~~~~|    |  .'     |    | |~~~~~~~~|   |
/'______|___||__###___|____|/'_______|____|_|__###___|___|


<a style="color: blue">[1]</a> Introdução

Olá ! Hoje vamos explorar o fascinante mundo do ICS (Sistema de Controle Industrial) e do SCADA (Supervisório de Controle e Aquisição de Dados) 
e entender de forma simples como essas tecnologias funcionam para controlar e monitorar processos industriais.

<a style="color: blue">[2]</a> Oque é ICS e SCADA?

O ICS é um sistema utilizado em indústrias para automatizar e controlar os processos de produção.
Ele utiliza uma combinação de hardware, software e comunicação de dados para garantir o funcionamento eficiente das máquinas e equipamentos.
Imagine o ICS como um cérebro que coordena e supervisiona tudo o que acontece em uma fábrica.Dentro do ICS, encontramos o SCADA, que é uma parte fundamental do sistema. O SCADA 
atua como um supervisor coletando informações de sensores e dispositivos espalhados pela fábrica e mostrando esses dados em uma tela para os operadores visualizarem. É como um 
painel de controle que permite aos operadores monitorar e controlar os processos industriais em tempo real.
O SCADA se comunica com os dispositivos por meio de protocolos de comunicação, que são como idiomas que permitem a troca de informações. 
Esses protocolos permitem que o SCADA se conecte e obtenha dados de sensores, controladores e outros dispositivos presentes na fábrica.

<a style="color: blue">[3]</a> Importancia? 

O ICS está presente em quase todos os setores economicos e infraestruturas criticas de uma nação, como 
usinas de energia eletrica e nuclear, Água e saneamento, Petróleo e gás, Manufatura e automação, Transporte e logística e etc
isso em uma escala de danos é oque mais afeta uma população em caso de guerra, por isso esses sistemas são tao explorados

<a style="color: blue">[4]</a> Como explorar?

Algums protocolos usandos em ICSs e suas vulnerabilidades:

<a style="color: red">Modbus</a>:

    O objetivo principal do Modbus é permitir a comunicação entre dispositivos mestre (master) e escravo (slave) em uma rede.
    desenvolvido na década de 1970 e ainda é amplamente utilizado hoje em dia, sendo um protocolo antigo está sujeito a diversas falhas,
    ataques de negação de serviço (DoS), interceptação de tráfego. Se tratando de um protocolo antigo o Modbus não possui sistema de 
    autentificação ou seja qualquer um pode executar comandos de um administrator como desligar o PLC apenas estando dentro da rede:
    voce pode usar esse recurso do metasploit para fazer isso:
                # nmap -Pn -sT -p502 --script modbus-discover <target>
                # msf6> use  auxiliary/admin/scada/modicon_command           
    ou tambem voce pode usar esse framework focado apenas em exploração de Modbus para realizar ataques: https://github.com/C4l1b4n/ModBusSploit

<a style="color: red">IEC104</a>:

    é uma extensão ao protocolo IEC 60870-5-101, utilizado em sistemas de automação e controle de processos industriais, especialmente em sistemas de energia. 
    Ele define protocolos e formatos de mensagens para permitir a troca de dados entre dispositivos em uma rede. roda na porta 2404 e voce pode usa o metasloit 
    como client para o IEC104 e enviar uma lista de comandos
                # msf > use auxiliary/client/iec104/iec104


<a style="color: red">Siemens S7</a>:
    
    família de controladores lógicos programáveis (PLCs) fabricados pela Siemens AG. 
    roda na porta 102 e possui vulnerabilidades e pode ser explorado usando o metasploit ou o framework ISF pra ics https://github.com/dark-lbp/isf
                # nmap -Pn -sT -p102 --script s7-info <target>
                # https://www.exploit-db.com/exploits/50613
                # https://www.exploit-db.com/exploits/19832
                # https://www.exploit-db.com/exploits/19831
                # isf > use exploits/plcs/siemens/s7_300_400_plc_control



outros protocolos utilizados, voce pode pesquisar mais sobre eles:

    <a style="color: red">DNP3 (Distributed Network Protocol)</a>
    <a style="color: red">EtherNet/IP</a>
    <a style="color: red">Profinet</a>


<a style="color: blue">[5]</a> Considerações finais

Voce pode tambem usar o shodan.io para encontrar ips com protocos ics abertos para internet, apenas age de forma ética (NÃO EXPLODA UMA USINA NUCLEAR XD !!!)
Agora que ja tem uma noção boa de ICS, voce pode pesquisar mais a fundo! Obrigado por ler, de seu amigo cibernético.

                                                                                            - Kasparov.
